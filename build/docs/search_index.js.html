<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>search/index.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <li class="nav-link nav-home-link"><a href="index.html">Home</a></li><li class="nav-heading">Tutorials</li><li class="nav-item"><a href="tutorial-gitflow.html">gitflow</a></li><li class="nav-heading">Classes</li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Chats.html">Chats</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Config.html">Config</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Config.html#manage">manage</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Config.html#renderSelf">renderSelf</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Config.html#reView">reView</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Config.html#updateHrsConfig">updateHrsConfig</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Config.html#view">view</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Config.html#viewCards">viewCards</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Config.html#viewConfigCards">viewConfigCards</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Config.html#viewLocationCards">viewLocationCards</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Dashboard.html">Dashboard</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Dashboard.html#renderSelf">renderSelf</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Dashboard.html#reView">reView</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Dashboard.html#view">view</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Data.html">Data</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Data.html#.algoliaIndex">algoliaIndex</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Data.html#.listen">listen</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Data.html#.updateLocation">updateLocation</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Data.html#.updateUser">updateUser</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Data.html#init">init</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Data.html#initGrades">initGrades</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Data.html#initHourlyCharges">initHourlyCharges</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Data.html#initLocations">initLocations</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Data.html#initPeriods">initPeriods</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Data.html#initTimes">initTimes</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="EditApptDialog.html">EditApptDialog</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="EditApptDialog.html#renderSelf">renderSelf</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="EditAvailabilityDialog.html">EditAvailabilityDialog</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="EditHourDialog.html">EditHourDialog</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="EditLocationDialog.html">EditLocationDialog</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="EditLocationDialog.html#addHourInput">addHourInput</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="EditLocationDialog.html#manage">manage</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="EditLocationDialog.html#removeHourInput">removeHourInput</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="EditLocationDialog.html#renderSelf">renderSelf</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="EditLocationDialog.html#reset">reset</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="EditLocationDialog.html#save">save</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="EditLocationDialog.html#view">view</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="EditRequestDialog.html">EditRequestDialog</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="EditRequestDialog.html#renderSelf">renderSelf</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="EditSubjectDialog.html">EditSubjectDialog</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="EditSubjectDialog.html#manage">manage</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="EditSubjectDialog.html#renderSelf">renderSelf</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="EditSubjectDialog.html#section">section</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="EditSubjectDialog.html#updateSelected">updateSelected</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="EditSubjectDialog.html#view">view</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Help.html">Help</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Help.html#logout">logout</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Help.html#view">view</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="NewLocationDialog.html">NewLocationDialog</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="NewLocationDialog.html#addHourInput">addHourInput</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="NewLocationDialog.html#manage">manage</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="NewLocationDialog.html#removeHourInput">removeHourInput</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="NewLocationDialog.html#renderSelf">renderSelf</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="NewLocationDialog.html#reset">reset</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="NewLocationDialog.html#save">save</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="NewLocationDialog.html#view">view</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="NewPastApptDialog.html">NewPastApptDialog</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="NewPastApptDialog.html#.renderHit">renderHit</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="NewPastApptDialog.html#.searchPupils">searchPupils</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="NewPastApptDialog.html#.searchTutors">searchTutors</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="NewPastApptDialog.html#manage">manage</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="NewPastApptDialog.html#refreshData">refreshData</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="NewPastApptDialog.html#renderSelf">renderSelf</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="NewPastApptDialog.html#updateClockingTimes">updateClockingTimes</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Render.html">Render</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Render.html#searchTextFieldItem">searchTextFieldItem</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Schedule.html">Schedule</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Schedule.html#.getDayAndDateString">getDayAndDateString</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Schedule.html#.getNextDateWithDay">getNextDateWithDay</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Schedule.html#.renderDateDivider">renderDateDivider</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Schedule.html#loadMore">loadMore</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Schedule.html#manage">manage</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Schedule.html#refresh">refresh</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Schedule.html#renderSelf">renderSelf</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Schedule.html#reView">reView</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Schedule.html#reViewAppts">reViewAppts</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Schedule.html#view">view</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Schedule.html#viewAppt">viewAppt</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Schedule.html#viewAppts">viewAppts</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="SearchHeader.html">SearchHeader</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="SearchHeader.html#search">search</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Stats.html">Stats</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Stats.html#renderSelf">renderSelf</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Stats.html#view">view</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Stats.html#viewCards">viewCards</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Stats.html#viewRecentActivityCards">viewRecentActivityCards</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Stats.html#viewServiceHourCards">viewServiceHourCards</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="SubjectSelectDialog.html">SubjectSelectDialog</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="SubjectSelectDialog.html#manage">manage</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="SubjectSelectDialog.html#renderSelf">renderSelf</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="SubjectSelectDialog.html#section">section</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="SubjectSelectDialog.html#updateSelected">updateSelected</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="SubjectSelectDialog.html#view">view</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="SupervisorChats.html">SupervisorChats</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="SupervisorChats.html#getAnnouncements">getAnnouncements</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="SupervisorChats.html#renderAnnouncementItem">renderAnnouncementItem</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="SupervisorChats.html#viewAnnouncements">viewAnnouncements</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="SupervisorSchedule.html">SupervisorSchedule</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="SupervisorSchedule.html#.renderShortcutCard">renderShortcutCard</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="SupervisorSchedule.html#loadMore">loadMore</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="SupervisorSchedule.html#manage">manage</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="SupervisorSchedule.html#refresh">refresh</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="SupervisorSchedule.html#renderHit">renderHit</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="SupervisorSchedule.html#renderSelf">renderSelf</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="SupervisorSchedule.html#reView">reView</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="SupervisorSchedule.html#reViewAppts">reViewAppts</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="SupervisorSchedule.html#view">view</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="SupervisorSchedule.html#viewAppt">viewAppt</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="SupervisorSchedule.html#viewAppts">viewAppts</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Templates.html">Templates</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Tutorbook.html">Tutorbook</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Tutorbook.html#init">init</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Tutorbook.html#initOnMobile">initOnMobile</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Tutorbook.html#initRootConfig">initRootConfig</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Tutorbook.html#initUser">initUser</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Tutorbook.html#initWebsiteConfig">initWebsiteConfig</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Tutorbook.html#loader">loader</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Tutorbook.html#login">login</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Tutorbook.html#logJobPost">logJobPost</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Tutorbook.html#preInit">preInit</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Tutorbook.html#print">print</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Tutorbook.html#signOut">signOut</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Tutorbook.html#syncConfig">syncConfig</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Tutorbook.html#updateUser">updateUser</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Tutorbook.html#view">view</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Utils.html">Utils</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Utils.html#.attachHeader">attachHeader</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Utils.html#.getOtherUser">getOtherUser</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Utils.html#.parseHourString">parseHourString</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Utils.html#.parseHourStrings">parseHourStrings</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Utils.html#.recycle">recycle</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Utils.html#.viewRaw">viewRaw</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="ViewApptDialog.html">ViewApptDialog</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ViewApptDialog.html#clockIn">clockIn</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ViewApptDialog.html#clockOut">clockOut</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ViewApptDialog.html#manage">manage</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ViewApptDialog.html#renderSelf">renderSelf</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ViewApptDialog.html#update">update</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ViewApptDialog.html#view">view</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="ViewCanceledRequestDialog.html">ViewCanceledRequestDialog</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ViewCanceledRequestDialog.html#manage">manage</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ViewCanceledRequestDialog.html#renderSelf">renderSelf</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ViewCanceledRequestDialog.html#view">view</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="ViewModifiedRequestDialog.html">ViewModifiedRequestDialog</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ViewModifiedRequestDialog.html#manage">manage</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ViewModifiedRequestDialog.html#renderSelf">renderSelf</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ViewModifiedRequestDialog.html#view">view</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="ViewRejectedRequestDialog.html">ViewRejectedRequestDialog</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ViewRejectedRequestDialog.html#manage">manage</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ViewRejectedRequestDialog.html#renderSelf">renderSelf</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ViewRejectedRequestDialog.html#view">view</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="ViewRequestDialog.html">ViewRequestDialog</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ViewRequestDialog.html#manage">manage</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ViewRequestDialog.html#renderSelf">renderSelf</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ViewRequestDialog.html#view">view</a></span></li><li class="nav-heading"><a href="global.html">Globals</a></li><li class="nav-item"><span class="nav-item-type type-member">M</span><span class="nav-item-name"><a href="global.html#app">app</a></span></li>
</nav>

<div id="main">
    
    <h1 class="page-title">search/index.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import {
    MDCRipple
} from '@material/ripple/index';
import {
    MDCTopAppBar
} from '@material/top-app-bar/index';

import $ from 'jquery';
import to from 'await-to-js';

const EditProfile = require('@tutorbook/profile').edit;
const User = require('@tutorbook/user');
const FilterDialog = require('@tutorbook/filters').default;
const Utils = require('@tutorbook/utils');
const Data = require('@tutorbook/data');
const NotificationDialog = require('@tutorbook/dialogs').notify;

/**
 * Class that represents the `mdc-top-app-bar` with a Google-like search bar
 * that opens an elevated search results `mdc-list`.
 */
class SearchHeader {

    constructor(options = {}) {
        this.render = window.app.render;
        this.index = options.index ? options.index : Data.algoliaIndex('users');
        if (options.search) this.search = options.search;
        this.renderSelf(options);
    }

    renderSelf(options) {
        this.el = this.render.header('header-search', Utils.combineMaps({
            title: 'Tutorbook',
            wordmark: false,
            logo: false,
            placeholder: window.app.onMobile ? 'Search users' : 'Search users' +
                ' by name, subject, availability, and more',
        }, options));
    }

    /**
     * Searches users via [Algolia]{@link https://algolia.com} (and adds the
     * necessary `facetFilters` in order to only show data relevant to the
     * current user).
     * @see {@link https://www.algolia.com/doc/api-reference/api-parameters/facetFilters/}
     */
    async search(that) {
        const query = $(that.el).find('.search-box input').val();
        query.length > 0 ? that.showClearButton() : that.showInfoButton();
        const [err, res] = await to(that.index.search({
            query: query,
            facetFilters: !window.app.id ? [] : [
                'payments.type:Free',
                window.app.locations.map(l => 'location:' + l.name),
            ],
        }));
        if (err) return console.error('Could not search users b/c of', err);
        $(that.el).find('#results').empty();
        res.hits.forEach((hit) => {
            try {
                $(that.el).find('#results').append(that.renderHit(hit));
            } catch (e) {
                console.warn('[ERROR] Could not render hit (' + hit.objectID +
                    ') b/c of', e);
            }
        });
    }

    manage() {
        $(this.el).find('.search-box button').each(function() {
            MDCRipple.attachTo(this).unbounded = true;
        });
        $(this.el).find('#info-button').click(() => new NotificationDialog(
            'About Search',
            'Tutorbook\'s new search bar is an app-wide search feature to' +
            ' make your job easier. From the search bar, you can find, ' +
            'match, and message students, schedule or cancel appointments' +
            ', and start service hour timers for tutors at your ' +
            'location(s).', () => {}).view());
        $(document).click((event) => {
            const $target = $(event.target);
            const clicked =
                $target.closest($(this.el).find('.search-results')).length ||
                $target.closest($(this.el).find('.search-box')).length;
            const open = $(this.el).find('.search-results').is(':visible');
            if (!clicked &amp;&amp; open) return this.hideResults();
            if (clicked &amp;&amp; !open) return this.showResults();
        });
        $(this.el).find('.search-box input').on('input', () => this.search(this))
            .focusout(() => {
                if (!$(this.el).find('.search-results li:hover').length)
                    this.hideResults();
            })
            .focus(() => this.showResults());
        this.search(this); // TODO: Show filter prompts instead of results
        $(this.el).find('#clear-button').click(() => {
            $(this.el).find('.search-box input').val('');
            this.showInfoButton();
            this.search(this);
        });
    }

    showInfoButton() {
        if (window.app.onMobile) return;
        $(this.el).find('#clear-button').hide();
        $(this.el).find('#info-button').show();
    }

    showClearButton() {
        if (window.app.onMobile) return;
        $(this.el).find('#info-button').hide();
        $(this.el).find('#clear-button').show();
    }

    showResults() {
        $(this.el).find('.search-results').show();
        $(this.el).find('.search-box')
            .addClass('search-box--elevated');
    }

    hideResults() {
        $(this.el).find('.search-results').hide();
        $(this.el).find('.search-box')
            .removeClass('search-box--elevated');
    }

    renderHit(hit) {
        return SearchHeader.renderHit(hit, this.render);
    }

    static renderHit(hit, render) { // TODO: Remove code duplication from Search()
        var el;
        const profile = Utils.filterProfile(hit);
        const match = new window.app.MatchingDialog(profile);
        const edit = new EditProfile(profile);
        const user = new User(profile);
        const listItemData = Utils.cloneMap(profile);
        listItemData.id = hit.objectID;
        listItemData.go_to_user = (event) => {
            if ($(event.target).closest('button').length) return;
            user.view();
        };
        listItemData.match = () => {
            match.view();
        };
        listItemData.edit = () => {
            edit.view();
        };
        listItemData.chat = async () => {
            (await window.app.chats.newWith(profile)).view();
        };
        listItemData.hrs = async () => {
            window.app.snackbar.view('Generating service hour log...');
            const [err, res] = await to(Data.getServiceHoursLog({
                uid: profile.uid,
            }));
            if (err) return window.app.snackbar.view('Could not generate ' +
                'service hour log.');
            window.app.snackbar.view('Generated service hour log.', 'view',
                () => window.open(res), false);
        };
        listItemData.grade = profile.grade || 'No Grade';
        listItemData.type = profile.type || 'No Type';

        if (profile.payments.type === 'Paid') {
            listItemData.type = 'Tutor';
            listItemData.paid = true;
            listItemData.free = false;
            listItemData.rate = '$' + profile.payments.hourlyCharge.toFixed(0);
            listItemData.paymentType = 'paid';
            listItemData.showHrs = false;
        } else {
            listItemData.free = true;
            listItemData.paid = false;
            listItemData.paymentType = 'free';
            if (profile.type === 'Tutor') listItemData.showHrs = true;
        }

        el = render.template('search-hit-user', listItemData);
        MDCRipple.attachTo(el);
        $(el).find('button').each(function() {
            MDCRipple.attachTo(this).unbounded = true;
        });
        return el;
    }
}


// Class that manages the Tutorbook search screen and results. See: 
// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes
class Search {

    constructor() {
        this.users = {}; // Store user objects in cache for responsiveness
        this.profiles = {}; // Store raw user data
        this.render = window.app.render;
        this.filters = {
            grade: 'Any',
            subject: 'Any',
            gender: 'Any',
            showBooked: false,
            availability: {},
            location: window.app.location.name,
            price: (window.app.location.name === 'Any') ? 'Any' : 'Free',
            type: 'Tutor',
            sort: 'Rating'
        };
        this.validGrades = window.app.data.grades;
        this.initDescription();
        // This has to be defined within a function to have access to `this`
        this.recycler = {
            remove: (doc) => {
                return $(this.main).find('#results [id="' + doc.id +
                    '"]').remove();
            },
            display: (doc) => {
                if (this.validResult(doc.data()))
                    return this.viewResult(this.renderResult(doc));
            },
            empty: () => {
                return $(this.main).find('#results').empty()
                    .append(this.emptySearch);
            },
        };
        this.renderSelf();
    }

    // Checks if the profile should show up in search results
    validResult(profile) {
        if (this.validGrades.indexOf(profile.grade) &lt; 0) {
            return false;
        } else if (profile.subjects.length === 0) {
            return false;
        } else if (profile.type === '' || profile.type === undefined) {
            return false;
        } else if (Object.keys(this.filters.availability).length !== 0 &amp;&amp;
            this.filters.subject !== 'Any' &amp;&amp;
            profile.subjects.indexOf(this.filters.subject) &lt; 0) {
            return false;
        }
        return true;
    }

    // Returns an MDC List Item for a given profile doc
    renderResult(doc) {
        const profile = doc.data();
        const user = new User(profile);
        this.profiles[profile.uid] = profile;
        this.users[profile.uid] = user;
        var listItemData = Utils.cloneMap(profile);
        listItemData['id'] = doc.id;
        listItemData['go_to_user'] = () => {
            user.view();
        };

        if (profile.payments.type === 'Paid') {
            listItemData.type = 'Tutor';
            listItemData.paid = true;
            listItemData.free = false;
            listItemData.rate = '$' + profile.payments.hourlyCharge.toFixed(0);
            listItemData.paymentType = 'paid';
        } else {
            listItemData.free = true;
            listItemData.paid = false;
            listItemData.paymentType = 'free';
        }

        const el = this.render.template('search-result-user', listItemData);
        Utils.replaceElement(
            el.querySelector('.rating__meta'),
            this.render.rating(profile.avgRating)
        );
        MDCRipple.attachTo(el);
        return el;
    }

    // Function that refreshes the filter description
    initDescription() {
        this.filterDescription = '';

        switch (this.filters.price) {
            case 'Any':
                break;
            case 'Free':
                this.filterDescription += ' free ';
                break;
            default:
                this.filterDescription += ' paid ';
                break;
        };

        if (this.filters.gender !== 'Any') {
            this.filterDescription += this.filters.gender.toLowerCase() + ' ';
        }

        if (this.filters.grade !== 'Any') {
            this.filterDescription += this.filters.grade.toLowerCase();
        }

        if (this.filters.type !== 'Any') {
            if (this.filters.grade !== 'Any') {
                this.filterDescription += ' ' + this.filters.type.toLowerCase() + 's';
            } else {
                this.filterDescription += this.filters.type.toLowerCase() + 's';
            }
        } else {
            if (this.filters.grade === 'Any') {
                this.filterDescription += (this.filters.price === 'Any') ? 'all users' : 'users';
            } else if (this.filters.grade !== 'Freshman') {
                // "Freshman" is weird as it is the plural and singular
                this.filterDescription += 's';
            }
        }

        if (this.filters.subject !== 'Any') {
            this.filterDescription += ' for ' + this.filters.subject;
        }

        if (Object.keys(this.filters.availability).length !== 0) {
            this.filterDescription += ' available on ' +
                Utils.getAvailabilityString(this.filters.availability);
        }

        if (this.filters.sort === 'Rating') {
            this.filterDescription += ' sorted by rating';
        } else if (this.filters.sort === 'Reviews') {
            this.filterDescription += ' sorted by # of reviews';
        }

        // Make sure to cut off the filter description at a max of 20 characters
        // and less if we're on mobile.
        // TODO: Make these numbers based on the size of the window
        if ((!!window.app) ? window.app.onMobile : false) {
            this.filterDescription = this.shortenString(this.filterDescription, 50);
        } else {
            this.filterDescription = this.shortenString(this.filterDescription, 150);
        }
    }

    // Proxies to the app's view function
    view(filters) {
        $(this.header).find('#filter').click(() => {
            new FilterDialog(this.filters).view();
        });
        $(this.header).find('#clear').click(() => {
            this.filters = {
                grade: 'Any',
                subject: 'Any',
                gender: 'Any',
                showBooked: false,
                availability: {},
                location: window.app.location.name,
                price: (window.app.location.name === 'Any') ? 'Any' : 'Free',
                type: 'Any',
                sort: 'Rating'
            };
            this.viewResults();
        });
        if (!!filters) {
            Object.entries(filters).forEach((entry) => {
                var filter = entry[0];
                var val = entry[1];
                this.filters[filter] = val;
            });
            this.initDescription();
        }
        app.view(this.header, this.main, '/app/search');
        app.intercom.view(true);
        if (this.filters.type !== 'Any') {
            app.nav.selected = this.filters.type + 's';
        } else {
            app.nav.selected = 'Search';
        }
        MDCTopAppBar.attachTo(this.header);
        this.viewResults();
    }

    // Returns a map with a header and main view
    renderSelf() {
        this.header = this.render.header('header-filter', {
            'title': 'Search',
            'filter_description': this.filterDescription,
        });
        this.main = this.render.template('search');
    }

    // Views a certain result (adds it to our search results)
    viewResult(listItem) {
        const results = $(this.main).find('#results')[0];
        const existingLocationCard = results.querySelector(
            "[id='" + listItem.getAttribute('id') + "']"
        );
        if (existingLocationCard) {
            // modify
            results.insertBefore(listItem, existingLocationCard);
            results.removeChild(existingLocationCard);
        } else {
            // add
            results.append(listItem);
        }
    };

    // Adds listeners to existing view
    reView() {
        MDCTopAppBar.attachTo(this.header);
        $(this.header).find('#filter').click(() => {
            new FilterDialog(this.filters).view();
        });
        $(this.header).find('#clear').click(() => {
            this.filters = {
                grade: 'Any',
                subject: 'Any',
                gender: 'Any',
                showBooked: false,
                availability: {},
                location: window.app.location.name,
                price: (window.app.location.name === 'Any') ? 'Any' : 'Free',
                type: 'Any',
                sort: 'Rating'
            };
            this.viewResults();
        });
        this.reViewResults();
    }

    async reViewUser(id) {
        if (!this.users[id]) this.users[id] =
            new User((await Data.getUser(id)));
        return this.users[id].reView();
    }

    // Adds click listeners to existing search results
    reViewResults() {
        const users = this.users;
        $(this.main).find('.mdc-list-item').each(async function() {
            const id = $(this).attr('id');
            if (!!users[id]) { // Use cached user object
                return $(this).click(() => {
                    users[id].view();
                });
            }
            if (!id) {
                throw new Error('User search result\'s ID was undefined.');
            }
            const profile = await Data.getUser(id); // Create and cache user
            const user = new User(profile);
            users[id] = user;
            $(this).click(() => {
                user.view();
            });
        });
    }

    // Views search results for our filters
    viewResults() {
        var that = this;
        this.initDescription();
        $(this.header).find('[data-fir-content="filter_description"]')
            .text(this.filterDescription);
        this.emptyResults();
        window.app.listeners.push(this.getUsers().onSnapshot({
            error: (err) => {
                new NotificationDialog('Search Error', 'Sorry, but we can\'t ' +
                    'seem to search with those filters. Tutorbook seems to ' +
                    'have encountered this database error:\n\n' +
                    Utils.wrap(err.message, 50) + '\n\n Try changing your ' +
                    'filters or contact me with the above error message at ' +
                    'nicholaschiang@tutorbook.app or (650) 861-2723.',
                    () => {}).view();
                console.error('Could not show search results b/c of ', err);
            },
            next: (snapshot) => {
                if (!snapshot.size) {
                    return that.recycler.empty();
                }

                snapshot.docChanges().forEach((change) => {
                    if (change.type === 'removed') {
                        that.recycler.remove(change.doc);
                    } else {
                        that.recycler.display(change.doc);
                    }
                });
            },
        }));
    }

    // Empties search results
    emptyResults() {
        return $(this.main).find('#results').empty();
    }

    // Gets filtered users based on our filters
    getUsers() {
        if (firebase.auth().currentUser) {
            var query = window.app.db.collection('users')
                .where('config.showProfile', '==', true);
        } else {
            var query = window.app.db.collection('search');
        }

        if (this.filters.location !== 'Any') {
            query = query.where('location', '==', this.filters.location);
        }

        if (this.filters.grade !== 'Any') {
            query = query.where('grade', '==', this.filters.grade);
        }

        if (this.filters.gender !== 'Any') {
            query = query.where('gender', '==', this.filters.gender);
        }

        if (this.filters.type !== 'Any') {
            query = query.where('type', '==', this.filters.type);
        }

        if (Object.keys(this.filters.availability).length !== 0) {
            // NOTE: User availability is stored in the Firestore database as:
            // availability: {
            // 	Gunn Academic Center: {
            //     Friday: [
            //       { open: '10:00 AM', close: '3:00 PM' },
            //       { open: '10:00 AM', close: '3:00 PM' },
            //     ],
            //   },
            //   Paly Tutoring Center: {
            //   ...
            //   },
            // };
            // And it is referenced here in the filters as:
            // availability: {
            //  	location: 'Gunn Academic Center',
            //  	day: 'Monday',
            //  	fromTime: 'A Period',
            //  	toTime: 'B Period',
            // };
            var location = this.filters.availability.location;
            var day = this.filters.availability.day;
            var from = this.filters.availability.fromTime;
            var to = this.filters.availability.toTime;
            // TODO: Make this query accept values that are a larger range than
            // the given value (e.g. user wants a timeslot from 4:00 PM to 4:30 PM
            // but this filters out users with availability from 8:00 AM to 5:00 PM).
            query = query.where(
                'availability.' + location + '.' + day,
                'array-contains', {
                    open: from,
                    close: to,
                    booked: this.filters.showBooked || false,
                }
            );
        }

        switch (this.filters.price) {
            case 'Any':
                break;
            case 'Free':
                query = query.where('payments.type', '==', 'Free');
                break;
            default:
                query = query.where('payments.type', '==', 'Paid');
                break;
        };

        if (this.filters.subject !== 'Any' &amp;&amp;
            Object.keys(this.filters.availability).length === 0) {
            // NOTE: We can only include one array-contains statement in any given
            // Firestore query. So, to do this, we check if the users in the 
            // resulting query have this subject (in the searchRecycler).
            query = query
                .where('subjects', 'array-contains', this.filters.subject);
        }

        if (this.filters.sort === 'Rating') {
            query = query.orderBy('avgRating', 'desc');
        } else if (this.filters.sort === 'Reviews') {
            query = query.orderBy('numRatings', 'desc');
        }

        return query.limit(500);
    }

    // Helper function to cut off strings with a ...
    shortenString(str, length) {
        if (str.length &lt;= length) {
            return str;
        }
        var result = '';
        str.split('').forEach((chr) => {
            if (result.length &lt; length - 3) {
                result += chr;
            }
        });
        result += '...';
        return result;
    }
};


module.exports = {
    default: Search,
    header: SearchHeader,
};</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.3</a> on Fri Feb 28 2020 12:55:46 GMT-0800 (Pacific Standard Time) using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
